<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />

    <!---display in device width-->
    <meta name="viewport" content="width=device-width, viewport-fit=auto" />
    <!---i don't think this is doing anything-->

    <meta name="author" content="Katherine Fagrell" />
    <meta
      name="description"
      content="This is the website for our experiment on climate change cognition."
    />

    <title>Experiment</title>

    <!--add Pavlovia functionality-->
    <script src="https://unpkg.com/jspsych@8.2.1"></script>
    <!--"quoted from pavlovia doc"--->
    <link
      href="https://unpkg.com/jspsych@8.2.1/css/jspsych.css"
      rel="stylesheet"
      type="text/css"
    />
    <script
      type="text/javascript"
      src=" https://pavlovia.org/lib/jspsych-7-pavlovia-2022.1.1.js"
    ></script>

    <!--jsPsych and plugins-->
    <!---<script src="https://unpkg.com/jspsych@7.3.4"></script>--->
    <link
      href="https://unpkg.com/jspsych@7.3.4/css/jspsych.css"
      rel="stylesheet"
      type="text/css"
    />

    <script src="https://unpkg.com/@jspsych/plugin-preload@1.1.3"></script>
    <script src="https://unpkg.com/@jspsych/plugin-html-keyboard-response@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-survey-likert@1.1.3"></script>
    <script src="https://unpkg.com/@jspsych/plugin-instructions@1.1.4"></script>

    <!--link jsPsych css stylesheet-->
    <link
      href="https://unpkg.com/jspsych@8.2.2/css/jspsych.css"
      rel="stylesheet"
      type="text/css"
    />
  </head>

  <body></body>

  <script>
    //this experiment using likert scales will record the follow data for each participant:
    //response, response time in milliseconds, question order

    //this is where the JavaScript will go to add functionality to the website

    //initialize jsPsych
    //const jsPsych = initJsPsych();

    var jsPsych = initJsPsych();

    //initialize Pavlovia connection
    const pavlovia_init = {
      type: jsPsychPavlovia,
      command: "init",
    };

    //trial to finish connection with pavlovia.org
    var pavlovia_finish = {
      type: jsPsychPavlovia,
      command: "finish",
    };

    //initialize timeline with empty array, trials will be added as they are created
    let timeline = [];

    timeline.push(pavlovia_init);

    var preload = {
      type: jsPsychPreload,
      images: ["condition1.png", "condition2.png"], // images are binary_0.421774511013192_ & continuous_0.389863323689087_.png respectively from lake_experiment_dallinger with labels removed and renamed
    };

    const likert_scale = [
      "Strongly Disagree",
      "Disagree",
      "Neutral",
      "Agree",
      "Strongly Agree",
    ];

    //condition 1 = binary data graph
    const condition1LikertScale = {
      type: jsPsychSurveyLikert,
      preamble: '<img src="condition1.png" style="width: 100%"></img>',
      questions: [
        {
          prompt: "This is question 0.",
          labels: likert_scale,
          required: true,
        },
        {
          prompt: "This is question 1.",
          labels: likert_scale,
          required: true,
        },
        {
          prompt: "This is question 2.",
          labels: likert_scale,
          required: true,
        },
        {
          prompt: "This is question 3.",
          labels: likert_scale,
          required: true,
        },
      ],
      randomize_question_order: true,
    };

    //condition 2 = cont data graph
    const condition2LikertScale = {
      type: jsPsychSurveyLikert,
      preamble: '<img src="condition2.png" style="width: 100%"></img>',
      questions: [
        {
          prompt: "This is question 0.",
          labels: likert_scale,
          required: true,
        },
        {
          prompt: "This is question 1.",
          labels: likert_scale,
          required: true,
        },
        {
          prompt: "This is question 2.",
          labels: likert_scale,
          required: true,
        },
        {
          prompt: "This is question 3.",
          labels: likert_scale,
          required: true,
        },
      ],
      randomize_question_order: true,
    };

    //add to experiment timeline

    //trial 1: welcome page
    //add examples if needed
    const instructions = {
      type: jsPsychInstructions,
      pages: [
        "Welcome to the experiment. Press the 'next' button to begin.",
        "In this experiment, you will be shown multiple graphs of data and will be asked for your opinion about their significance",
        "By pressing 'next' to begin the experiment, you consent to the following: *insert consent here*",
      ],
      show_clickable_nav: true,
    };

    timeline.push(instructions);

    //trial 2: random assignment to condition 1 (binary) or condition 2 (continuous)
    // credit = https://www.jspsych.org/v8/reference/jspsych-randomization/#sample-with-equal-probability
    const myArray = [1, 2];
    var group = jsPsych.randomization.sampleWithReplacement(myArray, 1);

    //add trial 2 to end of timeline
    if (group == 1) {
      timeline.push(condition1LikertScale);
    } else {
      timeline.push(condition2LikertScale);
    }

    jsPsych.data.addProperties({ condition: group });

    //trial 3: finish page
    const finishPage = {
      type: jsPsychInstructions,
      pages: [
        "Thank you for your participation. If you ran into any issues, please message the researchers at cocopolucla@gmail.com.",
      ],
      show_clickable_nav: true,
    };
    timeline.push(finishPage);

    timeline.push(pavlovia_finish);

    //run experiment
    jsPsych.run(timeline);
  </script>
</html>
